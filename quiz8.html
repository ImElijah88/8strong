<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Java Concepts Quiz</title>
    <!-- Load Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
        background-size: 400% 400%;
        animation: gradientFlow 15s ease infinite;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }
      @keyframes gradientFlow {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }
      .glassmorphism {
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      }
      .submit-button {
        background: rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(5px);
        transition: all 0.3s ease;
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.5);
      }
      .submit-button:hover {
        background: rgba(255, 255, 255, 0.5);
      }
      .float-animation {
        animation: float 3s ease-in-out infinite;
      }
      @keyframes float {
        0% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
        100% {
          transform: translateY(0px);
        }
      }

      .sphere-button {
        position: absolute;
        z-index: 20;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.3s ease;
      }
      .sphere-button:hover {
        background: rgba(255, 255, 0, 0.4);
      }
      #ball-container {
        position: relative;
        width: 250px;
        height: 400px;
        border-radius: 16px;
        overflow: hidden;
        margin-bottom: 1.5rem;
      }
    </style>
  </head>
  <body class="p-4">
    <!-- Start Screen Modal -->
    <div
      id="start-modal"
      class="fixed inset-0 flex items-center justify-center p-4 z-50 bg-gray-800 bg-opacity-70"
    >
      <div
        class="glassmorphism text-white p-8 max-w-lg w-full text-center relative"
      >
        <h2 class="text-4xl font-bold mb-4">Java Concepts Quiz</h2>
        <p class="text-lg mb-6">Enter your name to start the quiz!</p>
        <input
          type="text"
          id="name-input"
          placeholder="Your Name"
          class="w-full p-2 mb-4 rounded-md glassmorphism text-white placeholder-white/80 focus:outline-none focus:ring-2 focus:ring-white"
        />
        <button
          id="start-button"
          class="w-32 h-12 rounded-full submit-button shadow-xl flex items-center justify-center text-center text-base font-bold"
        >
          Start Quiz
        </button>
      </div>
    </div>

    <!-- Main Quiz Container -->
    <div
      id="quiz-container"
      class="glassmorphism text-white p-8 max-w-4xl w-full mx-auto z-10 relative hidden"
    >
      <!-- Quiz Header -->
      <div class="flex flex-col sm:flex-row justify-between items-center mb-6">
        <h1 class="text-3xl font-bold">Java Quiz</h1>
        <div class="mt-4 sm:mt-0">
          <p class="text-lg font-semibold">
            Current Score: <span id="score-display">0</span>
          </p>
          <p class="text-lg font-semibold">
            Attempts Left: <span id="attempts-display">5</span>
          </p>
        </div>
      </div>

      <div class="mb-6">
        <div
          class="glassmorphism text-white p-3 rounded-lg text-center font-bold"
        >
          <span id="timer-display">30</span>
        </div>
        <p class="text-center text-sm mt-2">Select up to 4 correct answers.</p>
      </div>

      <div id="quiz-content">
        <!-- Question and Choices -->
        <p id="question-text" class="text-xl font-semibold mb-4">
          Loading question...
        </p>

        <div class="flex flex-row gap-8 justify-center">
          <div id="ball-container" class="glassmorphism">
            <!-- Bouncing spheres will be injected here by JavaScript -->
          </div>

          <div class="flex-1 self-center">
            <div class="flex">
              <div
                id="answers-container-left"
                class="flex flex-col gap-2 w-1/2 pr-2"
              ></div>
              <div
                id="answers-container-right"
                class="flex flex-col gap-2 w-1/2 pl-2"
              ></div>
            </div>
          </div>
        </div>

        <!-- Feedback -->
        <p id="feedback-text" class="text-center mt-4 text-lg font-medium"></p>
      </div>
    </div>

    <!-- Glassmorphism End Screen Modal -->
    <div
      id="end-screen-modal"
      class="hidden fixed inset-0 flex items-center justify-center p-4 z-50 bg-gray-800 bg-opacity-70"
    >
      <div
        class="glassmorphism text-white p-8 max-w-lg w-full text-center relative"
      >
        <h2 class="text-4xl font-bold mb-4">Quiz Finished!</h2>
        <p id="final-score" class="text-2xl mb-2">
          Final Score: <span class="font-bold">0</span>
        </p>
        <p class="text-lg mb-6">
          Correct Answers: <span id="correct-count" class="font-bold">0</span> |
          Wrong Answers: <span id="wrong-count" class="font-bold">0</span>
        </p>
        <h3 class="text-2xl font-semibold mb-2">High Scores</h3>
        <ul
          id="high-scores-list"
          class="flex flex-wrap justify-center gap-4 list-none text-lg"
        >
          <!-- High scores will be displayed here -->
        </ul>
        <button
          id="play-again-button"
          class="mt-8 w-20 h-20 rounded-full submit-button shadow-xl flex items-center justify-center text-center text-sm font-bold float-animation"
        >
          Play Again
        </button>
      </div>
    </div>

    <script>
      // Quiz Data
      const questions = [
        "Which of the following are Java primitive data types?",
        "Which of the following are Java access modifiers?",
        "Which of the following are valid Java collection classes?",
        "Which of the following are Java keywords?",
        "Which of the following are Java exception types?",
        "Which of the following are Java loop statements?",
        "Which of the following are Java OOP concepts?",
      ];

      const choices = [
        [
          "1. int",
          "2. String",
          "3. double",
          "4. boolean",
          "5. ArrayList",
          "6. char",
          "7. float",
          "8. HashMap",
        ],
        [
          "1. public",
          "2. private",
          "3. static",
          "4. protected",
          "5. final",
          "6. abstract",
          "7. default",
          "8. synchronized",
        ],
        [
          "1. ArrayList",
          "2. HashSet",
          "3. TreeMap",
          "4. LinkedList",
          "5. Vector",
          "6. HashMap",
          "7. Stack",
          "8. String",
        ],
        [
          "1. class",
          "2. import",
          "3. package",
          "4. extends",
          "5. implements",
          "6. function",
          "7. interface",
          "8. throws",
        ],
        [
          "1. NullPointerException",
          "2. IOException",
          "3. FileNotFoundException",
          "4. ArrayIndexOutOfBoundsException",
          "5. SQLException",
          "6. InterruptedException",
          "7. Error",
          "8. TimeoutException",
        ],
        [
          "1. for",
          "2. while",
          "3. do",
          "4. foreach",
          "5. loop",
          "6. switch",
          "7. if",
          "8. continue",
        ],
        [
          "1. Inheritance",
          "2. Polymorphism",
          "3. Encapsulation",
          "4. Abstraction",
          "5. Overloading",
          "6. Overriding",
          "7. Compilation",
          "8. Interface",
        ],
      ];

      const correctAnswers = [
        new Set([1, 3, 4, 6]), // int, double, boolean, char
        new Set([1, 2, 4, 7]), // public, private, protected, default
        new Set([1, 2, 3, 4]), // ArrayList, HashSet, TreeMap, LinkedList
        new Set([1, 2, 3, 4]), // class, import, package, extends
        new Set([1, 2, 3, 4]), // NullPointerException, IOException, FileNotFoundException, ArrayIndexOutOfBoundsException
        new Set([1, 2, 3]), // for, while, do
        new Set([1, 2, 3, 4]), // Inheritance, Polymorphism, Encapsulation, Abstraction
      ];

      let highScores = [];
      let playerName = "";
      let currentQuestionIndex = 0;
      let score = 0;
      let correctAnswersCount = 0;
      let incorrectAnswersCount = 0;
      let attemptsLeft = 5;
      let timerId;
      let answeredCorrectly = new Set();
      let answeredForQuestion = new Set();

      let ballPositions = [];
      let animationFrameId;

      // Get DOM elements
      const startModal = document.getElementById("start-modal");
      const nameInput = document.getElementById("name-input");
      const startButton = document.getElementById("start-button");
      const quizContainer = document.getElementById("quiz-container");
      const endScreenModal = document.getElementById("end-screen-modal");
      const questionText = document.getElementById("question-text");
      const ballContainer = document.getElementById("ball-container");
      const answersContainerLeft = document.getElementById(
        "answers-container-left"
      );
      const answersContainerRight = document.getElementById(
        "answers-container-right"
      );
      const scoreDisplay = document.getElementById("score-display");
      const attemptsDisplay = document.getElementById("attempts-display");
      const feedbackText = document.getElementById("feedback-text");
      const timerDisplay = document.getElementById("timer-display");
      const finalScore = document.getElementById("final-score");
      const correctCountDisplay = document.getElementById("correct-count");
      const wrongCountDisplay = document.getElementById("wrong-count");
      const highScoresList = document.getElementById("high-scores-list");
      const playAgainButton = document.getElementById("play-again-button");
      const ballSize = 60; // Sphere diameter

      // Event listener for the start button
      startButton.addEventListener("click", () => {
        playerName = nameInput.value.trim();
        if (playerName === "") {
          playerName = "Guest";
        }
        startModal.classList.add("hidden");
        quizContainer.classList.remove("hidden");
        loadQuestion();
      });

      function loadQuestion() {
        if (currentQuestionIndex >= questions.length) {
          endQuiz();
          return;
        }

        // Reset UI for new question
        feedbackText.textContent = "";
        ballContainer.innerHTML = "";
        answersContainerLeft.innerHTML = "";
        answersContainerRight.innerHTML = "";
        answeredCorrectly.clear();
        answeredForQuestion.clear();
        ballPositions = [];
        attemptsLeft = 5;
        if (attemptsDisplay) attemptsDisplay.textContent = attemptsLeft;

        questionText.textContent = questions[currentQuestionIndex];

        const numChoices = choices[currentQuestionIndex].length;
        const containerWidth = ballContainer.clientWidth;
        const containerHeight = ballContainer.clientHeight;

        choices[currentQuestionIndex].forEach((choice, index) => {
          // Create the floating sphere buttons
          const button = document.createElement("button");
          const choiceNumber = choice.split(".")[0];
          button.textContent = choiceNumber;
          button.dataset.number = choiceNumber;
          button.className =
            "sphere-button w-12 h-12 rounded-full glassmorphism text-gray-900 font-bold flex items-center justify-center text-center text-sm";
          button.addEventListener("click", handleChoiceClick);
          ballContainer.appendChild(button);

          // Initialize random position and velocity
          const x = Math.random() * (containerWidth - ballSize);
          const y = Math.random() * (containerHeight - ballSize);
          const vx = (Math.random() - 0.5) * 2; // Random speed from -1 to 1
          const vy = (Math.random() - 0.5) * 2; // Random speed from -1 to 1

          ballPositions.push({
            element: button,
            x,
            y,
            vx,
            vy,
            radius: ballSize / 2,
          });

          // Create the static answer text
          const choiceTextEl = document.createElement("p");
          choiceTextEl.textContent = choice;
          choiceTextEl.className = "text-sm";

          if (index < numChoices / 2) {
            answersContainerLeft.appendChild(choiceTextEl);
          } else {
            answersContainerRight.appendChild(choiceTextEl);
          }
        });

        startTimer();
        animateBalls();
      }

      function animateBalls() {
        ballPositions.forEach((ball) => {
          // Update position
          ball.x += ball.vx;
          ball.y += ball.vy;

          // Collision detection with container walls
          const containerWidth = ballContainer.clientWidth;
          const containerHeight = ballContainer.clientHeight;
          if (ball.x + ball.radius * 2 > containerWidth || ball.x < 0) {
            ball.vx *= -1; // Bounce off x-walls
          }
          if (ball.y + ball.radius * 2 > containerHeight || ball.y < 0) {
            ball.vy *= -1; // Bounce off y-walls
          }

          // Apply new position
          ball.element.style.transform = `translate(${ball.x}px, ${ball.y}px)`;
        });

        animationFrameId = requestAnimationFrame(animateBalls);
      }

      function handleChoiceClick(event) {
        const button = event.target;
        const choiceNumber = parseInt(button.dataset.number);
        const currentCorrectAnswers = correctAnswers[currentQuestionIndex];

        if (answeredForQuestion.has(choiceNumber)) {
          return;
        }
        answeredForQuestion.add(choiceNumber);

        attemptsLeft--;
        if (attemptsDisplay) attemptsDisplay.textContent = attemptsLeft;

        if (currentCorrectAnswers.has(choiceNumber)) {
          // Correct Answer
          button.classList.add("bg-green-500");
          button.classList.remove("glassmorphism", "text-gray-900");
          score += 100;
          correctAnswersCount++;
          answeredCorrectly.add(choiceNumber);
        } else {
          // Incorrect Answer
          button.classList.add("bg-red-500");
          button.classList.remove("glassmorphism", "text-gray-900");
          score -= 100;
          incorrectAnswersCount++;
        }

        // Disable button after click
        button.disabled = true;
        scoreDisplay.textContent = score;

        // Check if all correct answers have been selected
        const allCorrectSelected = [...currentCorrectAnswers].every(
          (answer) =>
            answeredForQuestion.has(answer) && currentCorrectAnswers.has(answer)
        );

        if (
          allCorrectSelected &&
          answeredCorrectly.size === currentCorrectAnswers.size
        ) {
          feedbackText.textContent = "Correct! You got it all right!";
          feedbackText.className =
            "text-center mt-4 text-lg font-medium text-green-400";
          clearInterval(timerId);
          cancelAnimationFrame(animationFrameId);
          setTimeout(nextQuestion, 2000);
        } else if (attemptsLeft === 0) {
          clearInterval(timerId);
          cancelAnimationFrame(animationFrameId);
          feedbackText.textContent =
            "No more attempts! The correct answers were: " +
            [...correctAnswers[currentQuestionIndex]].join(", ");
          feedbackText.className =
            "text-center mt-4 text-lg font-medium text-red-400";
          setTimeout(nextQuestion, 2000);
        }
      }

      function startTimer() {
        clearInterval(timerId);
        let timeLeft = 30;
        timerDisplay.textContent = timeLeft;

        timerId = setInterval(() => {
          timeLeft--;
          timerDisplay.textContent = timeLeft;
          if (timeLeft <= 0) {
            clearInterval(timerId);
            cancelAnimationFrame(animationFrameId);
            feedbackText.textContent =
              "Time's up! The correct answers were: " +
              [...correctAnswers[currentQuestionIndex]].join(", ");
            feedbackText.className =
              "text-center mt-4 text-lg font-medium text-red-400";
            setTimeout(nextQuestion, 2000);
          }
        }, 1000);
      }

      function nextQuestion() {
        currentQuestionIndex++;
        loadQuestion();
      }

      function endQuiz() {
        cancelAnimationFrame(animationFrameId);
        endScreenModal.classList.remove("hidden");

        finalScore.querySelector("span").textContent = score;
        correctCountDisplay.textContent = correctAnswersCount;
        wrongCountDisplay.textContent = incorrectAnswersCount;

        // Update high scores and display them
        highScores.push({ name: playerName, score: score });
        highScores.sort((a, b) => b.score - a.score);
        highScores = highScores.slice(0, 5);

        highScoresList.innerHTML = "";
        highScores.forEach((s, index) => {
          const li = document.createElement("li");
          li.textContent = `${index + 1}. ${s.name}: ${s.score} pts`;
          li.className =
            "bg-white/20 p-2 rounded-full flex items-center justify-center text-center text-sm font-bold float-animation w-28";
          highScoresList.appendChild(li);
        });
      }

      function restartQuiz() {
        currentQuestionIndex = 0;
        score = 0;
        correctAnswersCount = 0;
        incorrectAnswersCount = 0;
        scoreDisplay.textContent = score;
        endScreenModal.classList.add("hidden");
        loadQuestion();
      }

      // Add event listeners
      playAgainButton.addEventListener("click", restartQuiz);
    </script>
  </body>
</html>
